# Exemple de fichier de secrets pour whitelily (VM n8n automation)
# Copier ce fichier en secrets/whitelily.yaml et le chiffrer avec sops
#
# IMPORTANT: Ce fichier doit √™tre chiffr√© avant de le committer !
# NE JAMAIS COMMITTER LE FICHIER NON CHIFFR√â !
#
# Pour cr√©er et chiffrer le fichier de secrets:
# 1. Copier ce fichier: cp secrets/whitelily.yaml.example secrets/whitelily.yaml
# 2. √âditer avec sops: sops secrets/whitelily.yaml
# 3. Remplacer les valeurs avec vos vrais secrets
#
# IMPORTANT: Vous devez d'abord copier la cl√© age partag√©e sur la VM whitelily
# cp ~/.config/sops/age/key.txt √† /var/lib/sops-nix/key.txt (sur la VM)

# ========================================
# SECRETS UTILISATEUR
# ========================================

# Hash du mot de passe pour l'utilisateur jeremie
# G√©n√©rer avec: mkpasswd -m sha-512
# Le m√™me que pour magnolia si tu veux utiliser le m√™me mot de passe
jeremie-password-hash: $6$g/9Fke6IjYVALC5S$.uMMuJpIgro1MxwzBtvBMG7G2pP88ulMtl91kPWdg3nEuE3uigDQ164yqvtEEGKiFtuN8RaFok66AiIIwErvq1

# ========================================
# SECRETS N8N
# ========================================

# Cl√© de chiffrement n8n (CRITIQUE - NE JAMAIS PERDRE CETTE CL√â)
# G√©n√©rer avec: openssl rand -hex 32
# Cette cl√© chiffre toutes les credentials dans n8n
# Si tu la perds, tu perds TOUTES tes credentials n8n !
n8n:
  encryption_key: "REMPLACER_PAR_VRAIE_CLE_GENEREE_AVEC_OPENSSL_RAND_HEX_32"

  # Authentification basique n8n
  # Username pour l'acc√®s √† l'interface n8n
  basic_user: "admin"

  # Mot de passe pour l'acc√®s √† l'interface n8n
  # G√©n√©rer un mot de passe fort
  basic_pass: "REMPLACER_PAR_MOT_PASSE_FORT"

  # Mot de passe pour la base de donn√©es PostgreSQL
  # G√©n√©rer avec: openssl rand -base64 32
  db_password: "REMPLACER_PAR_MOT_PASSE_DB_GENERE_AVEC_OPENSSL"

# ========================================
# CLOUDFLARE TUNNEL
# ========================================

# Token du tunnel Cloudflare (SIMPLIFI√â !)
# Obtenir depuis: https://one.dash.cloudflare.com/
# ‚Üí Zero Trust ‚Üí Access ‚Üí Tunnels ‚Üí [Ton tunnel]
# Copier le TOKEN (la longue cha√Æne qui commence par "eyJ...")
cloudflared:
  token: "REMPLACER_PAR_TON_TOKEN_CLOUDFLARE"

# ========================================
# SECRETS GITHUB
# ========================================

# Token GitHub pour les mises √† jour automatiques de n8n
# Ce token permet au workflow GitHub Actions de cr√©er des PRs automatiquement
# lors de la d√©tection de nouvelles versions de n8n:next
#
# Permissions requises : repo (Full control of private repositories)
# G√©n√©rer sur : https://github.com/settings/tokens/new
# Documentation compl√®te : docs/GITHUB-TOKEN-SETUP.md
github:
  # Personal Access Token (classic) avec scope "repo"
  # Format : ghp_...
  token: "REMPLACER_PAR_TON_GITHUB_PAT"

# ========================================
# INSTRUCTIONS DE G√âN√âRATION DES SECRETS
# ========================================

# 1. Cl√© de chiffrement n8n (CRITIQUE) :
#    openssl rand -hex 32
#    Sauvegarder cette cl√© dans un gestionnaire de mots de passe !

# 2. Mot de passe basic_pass (fort) :
#    openssl rand -base64 24
#    ou utiliser un gestionnaire de mots de passe

# 3. Mot de passe DB PostgreSQL :
#    openssl rand -base64 32

# 4. Hash du mot de passe utilisateur :
#    mkpasswd -m sha-512
#    (te demandera d'entrer le mot de passe interactivement)

# 5. Cloudflare Tunnel token (SIMPLIFI√â !) :
#    a. Aller sur https://one.dash.cloudflare.com/
#    b. Navigation: Zero Trust ‚Üí Access ‚Üí Tunnels
#    c. Cr√©er un nouveau tunnel ou utiliser un existant
#    d. Configurer la route publique:
#       - Public hostname: n8nv2.jeremiealcaraz.com (ton domaine)
#       - Service: http://localhost:80
#       - Sauvegarder
#    e. Copier le TOKEN (la longue cha√Æne qui commence par "eyJ...")

# 6. GitHub Personal Access Token (pour auto-update n8n) :
#    a. Aller sur https://github.com/settings/tokens/new
#    b. Note: "n8n auto-update workflow"
#    c. Expiration: "No expiration" (ou 1 an selon pr√©f√©rence)
#    d. Scopes √† cocher:
#       ‚úÖ repo (Full control of private repositories)
#          ‚Üí Cocher TOUT le scope 'repo'
#    e. Cliquer sur "Generate token" en bas
#    f. COPIER LE TOKEN (commence par "ghp_...")
#       ‚ö†Ô∏è  Vous ne pourrez plus le voir apr√®s !
#    g. Documentation compl√®te: docs/GITHUB-TOKEN-SETUP.md

# ========================================
# CHECKLIST AVANT DE CHIFFRER
# ========================================
# [ ] Tous les "REMPLACER_PAR" ont √©t√© remplac√©s
# [ ] La cl√© encryption_key est sauvegard√©e dans un gestionnaire de mots de passe
# [ ] Le tunnel Cloudflare est cr√©√© et configur√©
# [ ] Le token Cloudflare est valide (commence par "eyJ...")
# [ ] Le token GitHub est valide (commence par "ghp_...")
# [ ] Le domaine est bien configur√© dans hosts/whitelily/n8n.nix
# [ ] Le token GitHub est aussi ajout√© dans GitHub Secrets (Settings ‚Üí Secrets ‚Üí Actions)

# ========================================
# COMMANDES POUR CHIFFRER
# ========================================
# sops secrets/whitelily.yaml
# (√©diter les valeurs, sauvegarder, sops chiffrera automatiquement)

# V√©rifier que c'est bien chiffr√© :
# cat secrets/whitelily.yaml | grep "sops:"

# Si oui, tu peux committer :
# git add -f secrets/whitelily.yaml
# git commit -m "üîí Add encrypted secrets for whitelily"
